<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Водонагреватели</title>
    <link href="../fahrenheit/styles.css" rel="stylesheet" type="text/css">
    <style>
        .form-container {
            margin: 0 auto;
            width: 75%;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 2px 2px 12px rgba(0, 0, 0, 0.1);
            background-color: #f9f9f9;
        }
        .form-title {
            text-align: center;
            margin-bottom: 20px;
            font-size: 24px;
        }
        .register-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .register-button {
            width: 100%;
            padding: 10px;
            background-color: #4B9CD3;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
        }
        .login-link {
            display: block;
            text-align: center;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <table width="100%" align="center" class="header">
        <tr>
            <td width="15%" align="left">
                <a href="index.html">
                    <img src="source/logo.png" alt="Логотип" class="logo">
                </a>
            </td>
            <td align="center">
                <h1 style="margin-top:35px" class="site-title">Фаренгейт</h1>
                <p style="margin-bottom:15px; color:white; font-size: large;">Лучший магазин сантехники!</p>
            </td>
            <td width="21.5%" align="right">
                <div class="login-block">
                    <table width="100%">
                        <tr>
                            <td align="right">
                                <input type="text" id="loginEmail" placeholder="логин" size="15" class="input-field">
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <input type="password" id="loginPassword" placeholder="пароль" size="15" class="input-field">
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <input type="submit" value="вход" class="submit-button" onclick="loginUser()">
                                <a href="authorize.html" class="register-link">регистрация</a>
                            </td>
                        </tr>
                    </table>
                </div>
            </td>
        </tr>
    </table>
    

<table border="0" width="100%" cellpadding="2" class="nav-table">
    <tr style="text-align: center;">
        <td align="center" width="25%">
            <a href="chapters/chapter1.html" class="nav-button" style="display: inline-block; width: 95%; text-align: center; padding: 8px; border-radius: 15px;">
                Радиаторы отопления
            </a>
        </td>
        <td align="center" width="25%">
            <a href="chapters/chapter2.html" class="nav-button" style="display: inline-block; width: 95%; text-align: center;  padding: 8px; border-radius: 15px;">
                Насосное оборудование
            </a>
        </td>
        <td align="center" width="25%">
            <a href="chapters/chapter3.html" class="nav-button" style="display: inline-block; width: 95%; text-align: center;  padding: 8px; border-radius: 15px;">
                Водонагреватели
            </a>
        </td>
        <td align="center" width="25%">
            <a href="chapters/chapter4.html" class="nav-button" style="display: inline-block; width: 95%; text-align: center; padding: 8px; border-radius: 15px;">
                Камины
            </a>
        </td>
    </tr>
</table>

<div id="mainContent">
    <table border="0" width="100%" cellpadding="25" align="center">
        <tr>
            
            <td width="11%" class="sidebar" valign="top" align="center">
                <ul class="nav-list">
                    <li class = "nav-button" style="width:75%"><a href="sales.html" class="nav-button">Скидки</a></li>
                    <li class = "nav-button" style="width:75%"><a href="geo.html" class="nav-button">Контакты</a></li>
                    <li class = "nav-button" style="width:75%"><a href="guarantee.html" class="nav-button">Гарантии</a></li>
                    <li class = "nav-button" style="width:75%"><a href="about_us.html" class="nav-button">О нас</a></li>
                </ul>
            </td>
    <!--Основной контент-->
            <td width="34%"  valign="center">
                <div class="form-container" style="height: 450px;">
                    <h2 class="form-title">Регистрация</h2>
                    <form id="registerForm">
                        <input type="text" name="name" placeholder="Имя пользователя" class="register-input" required>
                        <input type="text" name="phone" placeholder="Номер телефона" class="register-input" required>
                        <input type="email" name="email" placeholder="Электронная почта" class="register-input" required>
                        <input type="password" name="password" placeholder="Пароль" class="register-input" required>
                        <input type="password" name="confirm_password" placeholder="Подтвердите пароль" class="register-input" required>
                        <label>
                            <input type="checkbox" name="agree" required>
                            Я согласен(на) с <a href="https://farengeit-online.ru/agreement/" target="_blank">политикой обработки персональных данных</a>.
                        </label>
                        <br>
                        <button type="button" onclick="registerUser()" style="margin-top: 45px;" class="register-button">Зарегистрироваться</button>
                    </form>
                </div>
                
            </td>
    <!--Ьаннер правый -->
            <td width="12%" valign="top" align="center" class="ads-container">
                <strong>ПОИСК</strong>
                <br><input type="text" id="searchInput"style="margin-bottom: 5px;" value="" onkeyup=""><br>
                <input type="button" onclick="searchText()" style="font-weight: bold;" value="поиск"><br><br>
                <div class="ads-container">
                    <a href="https://www.premium-plumbing.co.uk/toilets/" target="_blank">
                        <img src="source/premiumPlumbing.jpg"
                             alt="Пример сайта"
                             class="ad-image">
                    </a>
                    <a href="https://www.americanplumbingflorida.com" target="_blank">
                        <img src="source/american plumbing.jpg"
                             alt="Пример сайта"
                             class="ad-image">
                    </a>
                    <a href="https://ukbathroomstore.co.uk/?srsltid=AfmBOor4c0OGMmLlAZLYVcwGSjImeYjqfPFB8TqIF5rymqOQNr2b2hWF" target="_blank">
                        <img src="source/spidertoilet.jpg"
                             alt="Пример сайта"
                             class="ad-image">
                    </a>
                </div>
            </td>
        </tr>
    </table>
</div>


<div class="footer">
    <p>© 2024 Магазин сантехники Фаренгейт. Все права защищены.</p>
</div>


<!-- JavaScript для поиска -->
<script>


function searchText() {
    // Получаем введенный текст
    let input = document.getElementById('searchInput').value.toLowerCase();
    let mainContent = document.getElementById('mainContent');

    // Убираем предыдущую подсветку
    let cleanedContent = mainContent.innerHTML.replace(/<mark>(.*?)<\/mark>/g, '$1');

    // Если поле ввода пустое, восстанавливаем текст без подсветки
    if (input.length === 0) {
        mainContent.innerHTML = cleanedContent;
        return; // Завершаем функцию
    }

    // Создаем регулярное выражение для поиска введенного текста
    let regex = new RegExp(`(${input})`, 'gi'); // 'g' - глобальный поиск, 'i' - не учитываем регистр

    // Подсвечиваем введенный текст
    let highlightedContent = cleanedContent.replace(regex, '<mark>$1</mark>');
    
    // Обновляем содержимое
    mainContent.innerHTML = highlightedContent;
}


function registerUser() {
    // Получаем форму и значения полей
    const form = document.getElementById('registerForm');
    const name = form.name.value.trim(); 
    const phone = form.phone.value.trim();  
    const email = form.email.value.trim();
    const password = form.password.value;
    const confirmPassword = form.confirm_password.value;
    const agree = form.agree.checked;

    // Проверка на обязательное заполнение всех полей
    if (!name || !email || !password || !confirmPassword) {
        alert("Пожалуйста, заполните все поля.");
        return;
    }

    // Проверка на совпадение паролей
    if (password !== confirmPassword) {
        alert("Пароли не совпадают.");
        return;
    }

    // Проверка на согласие с политикой обработки персональных данных
    if (!agree) {
        alert("Пожалуйста, подтвердите согласие с политикой обработки персональных данных.");
        return;
    }

    // Создаем тело запроса
    const requestData = {
        name: name,
        email: email,
        phoneNumber: phone,  
        password: password
    };

    // Отправка POST-запроса на API
    fetch('http://localhost:5000/api/v1/User/register', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(requestData)
    })
    .then(response => {
        if (response.ok) {
            // Если ответ успешен (код 200), показываем сообщение об успехе
            alert("Регистрация прошла успешно!");
        } else {
            // Если ответ не успешен, обрабатываем его как ошибку
            return response.json().then(data => {
                alert("Ошибка регистрации: " + (data.message || "Неизвестная ошибка"));
            });
        }
    })
    .catch(error => {
        console.error('Ошибка:', error);
        alert("Ошибка при отправке запроса.");
    });
}



function loginUser() {
    // Получаем значения полей логина и пароля
    const email = document.getElementById('loginEmail').value.trim();
    const password = document.getElementById('loginPassword').value.trim();

    // Проверка на пустые поля
    if (!email || !password) {
        alert("Пожалуйста, заполните оба поля.");
        return;
    }

    // Создаем тело запроса
    const loginData = {
        email: email,
        password: password
    };

    // Отправка POST-запроса на API
    fetch('http://localhost:5000/api/v1/User/login', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(loginData)
    })
    .then(response => {
        if (response.status === 200) {
            // Если ответ успешен (код 200), получаем токен
            return response.text();  // Читаем тело ответа как текст (токен)
        } else if (response.status === 500) {
            // Если сервер возвращает статус 500, выводим сообщение об ошибке
            alert("Ошибка: Неверные данные для входа.");
            return Promise.reject("Unauthorized");
        } else {
            // В случае других статусов — выводим сообщение об ошибке
            return response.text().then(error => {
                alert("Ошибка входа: " + error);
                return Promise.reject(error);
            });
        }
    })
    .then(token => {
        if (token) {
            // Если токен получен, сохраняем его в localStorage
            localStorage.setItem('token', token);  // Сохраняем токен
            alert("Вход выполнен успешно!");
        }
    })
    .catch(error => {
        console.error('Ошибка:', error);
    });
}



</script>


</body>
</html>

