<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Контакты</title>
    <link href="styles.css" rel="stylesheet" type="text/css">
</head>
<body>
    <table width="100%" align="center" class="header">
        <tr>
            <td width="15%" align="left">
                <a href="index.html">
                    <img src="source/logo.png" alt="Логотип" class="logo">
                </a>
            </td>
            <td align="center">
                <h1 style="margin-top:35px" class="site-title">Фаренгейт</h1>
                <p style="margin-bottom:15px; color:white; font-size: large;">Лучший магазин сантехники!</p>
            </td>
            <td width="21.5%" align="right">
                <div class="login-block">
                    <table width="100%">
                        <tr>
                            <td align="right">
                                <input type="text" id="loginEmail" placeholder="логин" size="15" class="input-field">
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <input type="password" id="loginPassword" placeholder="пароль" size="15" class="input-field">
                            </td>
                        </tr>
                        <tr>
                            <td align="right">
                                <input type="submit" value="вход" class="submit-button" onclick="loginUser()">
                                <a href="authorize.html" class="register-link">регистрация</a>
                            </td>
                        </tr>
                    </table>
                </div>
            </td>
        </tr>
    </table>
    

    <table border="0" width="100%" cellpadding="2" class="nav-table">
        <tr style="text-align: center;">
            <td align="center" width="25%">
                <a href="chapters/chapter1.html" class="nav-button" style="display: inline-block; width: 95%; text-align: center; padding: 8px; border-radius: 15px;">
                    Радиаторы отопления
                </a>
            </td>
            <td align="center" width="25%">
                <a href="chapters/chapter2.html" class="nav-button" style="display: inline-block; width: 95%; text-align: center;  padding: 8px; border-radius: 15px;">
                    Насосное оборудование
                </a>
            </td>
            <td align="center" width="25%">
                <a href="chapters/chapter3.html" class="nav-button" style="display: inline-block; width: 95%; text-align: center;  padding: 8px; border-radius: 15px;">
                    Водонагреватели
                </a>
            </td>
            <td align="center" width="25%">
                <a href="chapters/chapter4.html" class="nav-button" style="display: inline-block; width: 95%; text-align: center; padding: 8px; border-radius: 15px;">
                    Камины
                </a>
            </td>
        </tr>
    </table>
<div id="mainContent">
    <table border="0" width="100%" cellpadding="25" align="center">
        <tr>
            
            <td width="11%" class="sidebar" valign="top" align="center">
                <ul class="nav-list">
                    <li class = "nav-button" style="width:75%"><a href="sales.html" class="nav-button">Скидки</a></li>
                    <li class = "nav-button" style="width:75%"><a href="geo.html" class="nav-button">Контакты</a></li>
                    <li class = "nav-button" style="width:75%"><a href="guarantee.html" class="nav-button">Гарантии</a></li>
                    <li class = "nav-button" style="width:75%"><a href="about_us.html" class="nav-button">О нас</a></li>
                </ul>
            </td>
            <!--Основной контент-->
            <td width="34%" valign="top">
                <h1 align="center">Как до нас добраться?</h1>

            <p align="center">
                Наш офис расположен на юго-западе Москвы, вы можете добраться до нас следующими способами:
            </p>
            <ul style="list-style: none; padding: 0; text-align: center; width: 80%; margin: 0 auto;">
                <li><strong>Метро:</strong> станция Румянцево.</li>
                <li><strong>Телефон:</strong> +7 495 260-18-27</li>
                <li><strong>Email:</strong> info@farengeit-online.ru</li>
            </ul>
            

            <h2 align="center">Наша карта расположения</h2>
            <!-- Место для скриншота карты -->
            <div align="center">
                <img src="source/mapGeo.jpg" alt="Карта с местоположением" style="width: 80%; height: auto; border: 5px solid gainsboro;">
            </div>

            <p align="center">Вы можете посмотреть карту подробнее, перейдя по <a href="https://yandex.ru/maps/org/farengeyt/104731423778/?ll=37.762714%2C55.631008&mode=search&sctx=ZAAAAAgBEAAaKAoSCYnUtItp6kJAESFAho4d5ktAEhIJ2h1SDJCo%2Fz8RwcQfRZ055T8iBgABAgMEBSgKOABA1QFIAWoCcnWdAc3MzD2gAQCoAQC9AdP0dyPCAQui6OqThgPi0vv3A4ICEtCk0LDRgNC10L3Qs9C10LnRgooCAJICAJoCDGRlc2t0b3AtbWFwcw%3D%3D&sll=37.607017%2C55.631008&sspn=0.989326%2C0.333065&text=%D0%A4%D0%B0%D1%80%D0%B5%D0%BD%D0%B3%D0%B5%D0%B9%D1%82&z=10.76" 
                target="_blank">ссылке на Яндекс.Карты</a>.</p>


                <div class="feedback-form" style="width: 100%; margin-top: 20px; text-align: center; background-color: #f9f9f9; border-radius: 5px; border: black 1px;">
                    <h2>Обратная связь</h2>
                    <form action="/submit_feedback" method="post" id="feedbackForm"style="display: inline-block; text-align: left;">
                        <label for="name">Имя:</label><br>
                        <input type="text" id="name" name="name" size="40" required><br><br>
                        
                        <label for="email">Email:</label><br>
                        <input type="email" id="email" name="email" size="40" required><br><br>
                        
                        <label for="message">Сообщение:</label><br>
                        <textarea id="message" name="message" rows="5" cols="38" required></textarea><br><br>
                        
                        <input type="submit" value="Отправить" class="submit-button">
                    </form>
            </td>

            
    
            <td width="12%" valign="top" align="center" class="ads-container">
                <strong>ПОИСК</strong>
                <br><input type="text" id="searchInput"style="margin-bottom: 5px;" value="" onkeyup=""><br>
                <input type="button" onclick="searchText()" style="font-weight: bold;" value="поиск"><br><br>
                <div class="ads-container">
                    <a href="https://www.premium-plumbing.co.uk/toilets/" target="_blank">
                        <img src="source/premiumPlumbing.jpg"
                             alt="Пример сайта"
                             class="ad-image">
                    </a>
                    <a href="https://www.americanplumbingflorida.com" target="_blank">
                        <img src="source/american plumbing.jpg"
                             alt="Пример сайта"
                             class="ad-image">
                    </a>
                    <a href="https://ukbathroomstore.co.uk/?srsltid=AfmBOor4c0OGMmLlAZLYVcwGSjImeYjqfPFB8TqIF5rymqOQNr2b2hWF" target="_blank">
                        <img src="source/spidertoilet.jpg"
                             alt="Пример сайта"
                             class="ad-image">
                    </a>
                </div>
            </td>
        </tr>
        
    </table>
</div>


<div class="footer">
    <p>© 2024 Магазин сантехники Фаренгейт. Все права защищены.</p>
</div>


<!-- JavaScript для поиска -->
<script>


function searchText() {
    // Получаем введенный текст
    let input = document.getElementById('searchInput').value.toLowerCase();
    let mainContent = document.getElementById('mainContent');

    // Убираем предыдущую подсветку
    let cleanedContent = mainContent.innerHTML.replace(/<mark>(.*?)<\/mark>/g, '$1');

    // Если поле ввода пустое, восстанавливаем текст без подсветки
    if (input.length === 0) {
        mainContent.innerHTML = cleanedContent;
        return; // Завершаем функцию
    }

    // Создаем регулярное выражение для поиска введенного текста
    let regex = new RegExp(`(${input})`, 'gi'); // 'g' - глобальный поиск, 'i' - не учитываем регистр

    // Подсвечиваем введенный текст
    let highlightedContent = cleanedContent.replace(regex, '<mark>$1</mark>');
    
    // Обновляем содержимое
    mainContent.innerHTML = highlightedContent;
}
function loginUser() {

    



    // Получаем значения полей логина и пароля
    const email = document.getElementById('loginEmail').value.trim();
    const password = document.getElementById('loginPassword').value.trim();

    // Проверка на пустые поля
    if (!email || !password) {
        alert("Пожалуйста, заполните оба поля.");
        return;
    }

    // Создаем тело запроса
    const loginData = {
        email: email,
        password: password
    };

    // Отправка POST-запроса на API
    fetch('http://localhost:5000/api/v1/User/login', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(loginData)
    })
    .then(response => {
        if (response.status === 200) {
            // Если ответ успешен (код 200), получаем токен
            return response.text();  // Читаем тело ответа как текст (токен)
        } else if (response.status === 500) {
            // Если сервер возвращает статус 500, выводим сообщение об ошибке
            alert("Ошибка: Неверные данные для входа.");
            return Promise.reject("Unauthorized");
        } else {
            // В случае других статусов — выводим сообщение об ошибке
            return response.text().then(error => {
                alert("Ошибка входа: " + error);
                return Promise.reject(error);
            });
        }
    })
    .then(token => {
        if (token) {
            // Если токен получен, сохраняем его в localStorage
            localStorage.setItem('token', token);  // Сохраняем токен
            alert("Вход выполнен успешно!");
            feedbackForm.style.display = 'block';

        }
    })
    .catch(error => {
        console.error('Ошибка:', error);
    });

    
}
const form = document.getElementById('feedbackForm');

// Listen for form submission
form.addEventListener('submit', async (e) => {
    e.preventDefault(); // Prevent the default form submission
    
    // Get the message from the form
    const message = document.getElementById('message').value;
    const mail = document.getElementById('email').value;
    // Prepare the data for the request
    const feedbackData = {
        message: message,
        email: mail
    };

    try {
        // Send the feedback data as a POST request to your API
        const response = await fetch('http://localhost:5000/api/Feedback/createFeedback', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(feedbackData),  // Send the message as the request body
        });

        if (response.ok) {
            const responseData = await response.json();
            alert('Отзыв отправлен успешно!');
            console.log('Response:', responseData); // Optionally log the response data
        } else {
            alert('Произошла ошибка при отправке отзыва');
        }
    } catch (error) {
        alert('Произошла ошибка при отправке запроса');
        console.error('Error:', error);
    }
});


function deleteCookies() {
    // Получаем все куки
    const cookies = document.cookie.split(";");

    // Для каждого cookie устанавливаем его срок действия в прошлое, чтобы удалить
    cookies.forEach(cookie => {
        const cookieName = cookie.split("=")[0].trim();
        document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/;`;
    });
}
function getCookie(name) {
    const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));
    if (match) return match[2];
    return null;
}

// Функция для проверки, авторизован ли пользователь
function isAuthenticated() {
    // Проверяем наличие токена в куки (например, "auth_token")
    const token = getCookie('some-cookie'); // Подставьте имя вашего куки
    return token !== null;
}


deleteCookies();

function toggleFeedbackForm() {
        const feedbackForm = document.getElementById('feedbackForm');
        
        if (isAuthenticated()) {
            feedbackForm.style.display = 'block';  // Показываем форму, если авторизован
        } else {
            feedbackForm.style.display = 'none';  // Скрываем форму, если не авторизован
        }
    }

    // Выполняем функцию при загрузке страницы
    window.onload = function() {
        toggleFeedbackForm();
    };
</script>
</body>
</html>
